<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../../assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2724382-16'); </script> <script type="text/javascript" src="../../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Cache maintenance operations | Harmony 3 peripheral library application examples for PIC32MZ EF family</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Cache maintenance operations" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 peripheral library application examples for PIC32MZ EF family" /> <meta property="og:description" content="Harmony 3 peripheral library application examples for PIC32MZ EF family" /> <link rel="canonical" href="../../../apps/cache/cache_maintenance/readme.html" /> <meta property="og:url" content="../../../apps/cache/cache_maintenance/readme.html" /> <meta property="og:site_name" content="Harmony 3 peripheral library application examples for PIC32MZ EF family" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Cache maintenance operations" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Harmony 3 peripheral library application examples for PIC32MZ EF family","headline":"Cache maintenance operations","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"url":"../../../apps/cache/cache_maintenance/readme.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="../../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="../../../index.html" class="nav-list-link">Harmony 3 peripheral library application examples for PIC32MZ EF family</a><ul class="nav-list "><li class="nav-list-item "><a href="../../../apps/adchs/adchs_interrupt/readme.html" class="nav-list-link">ADCHS Interrupt</a></li><li class="nav-list-item "><a href="../../../apps/adchs/adchs_polled/readme.html" class="nav-list-link">ADCHS polling</a></li><li class="nav-list-item "><a href="../../../apps/can/can_normal_operation_blocking/readme.html" class="nav-list-link">CAN blocking</a></li><li class="nav-list-item "><a href="../../../apps/can/can_normal_operation_interrupt_timestamp/readme.html" class="nav-list-link">CAN interrupt</a></li><li class="nav-list-item "><a href="../../../apps/cmp/cmp_configurable_reference/readme.html" class="nav-list-link">CMP configurable reference</a></li><li class="nav-list-item "><a href="../../../apps/coretimer/coretimer_periodic_timeout/readme.html" class="nav-list-link">CORETIMER periodic interrupt</a></li><li class="nav-list-item active"><a href="../../../apps/cache/cache_maintenance/readme.html" class="nav-list-link active">Cache maintenance operations</a></li><li class="nav-list-item "><a href="../../../apps/clock/clock_config/readme.html" class="nav-list-link">Clock configuration</a></li><li class="nav-list-item "><a href="../../../apps/dmac/dmac_crc32_generate/readme.html" class="nav-list-link">DMAC CRC-32 Generation</a></li><li class="nav-list-item "><a href="../../../apps/dmac/dmac_memory_transfer/readme.html" class="nav-list-link">DMAC memory transfer</a></li><li class="nav-list-item "><a href="../../../apps/dmac/dmac_usart_echo/readme.html" class="nav-list-link">DMAC usart echo</a></li><li class="nav-list-item "><a href="../../../apps/dmac/dmac_usart_pattern_matching/readme.html" class="nav-list-link">DMAC usart echo using Pattern Matching</a></li><li class="nav-list-item "><a href="../../../apps/dmt/dmt_timeout/readme.html" class="nav-list-link">DMT timeout</a></li><li class="nav-list-item "><a href="../../../apps/ebi/ebi_sram_read_write/readme.html" class="nav-list-link">EBI SRAM read write</a></li><li class="nav-list-item "><a href="../../../apps/gpio/gpio_led_on_off_polling/readme.html" class="nav-list-link">GPIO Polling</a></li><li class="nav-list-item "><a href="../../../apps/gpio/gpio_led_on_off_interrupt/readme.html" class="nav-list-link">GPIO interrupt</a></li><li class="nav-list-item "><a href="../../../apps/icap/icap_capture_mode/readme.html" class="nav-list-link">ICAP capture mode</a></li><li class="nav-list-item "><a href="../../../apps/power/low_power_modes/readme.html" class="nav-list-link">Low Power Modes</a></li><li class="nav-list-item "><a href="../../../apps/nvm/flash_read_write/readme.html" class="nav-list-link">NVM flash read write</a></li><li class="nav-list-item "><a href="../../../apps/ocmp/ocmp_compare_mode/readme.html" class="nav-list-link">OCMP compare mode</a></li><li class="nav-list-item "><a href="../../../apps/rng/rng_random_number/readme.html" class="nav-list-link">RNG random number</a></li><li class="nav-list-item "><a href="../../../apps/rtcc/rtcc_alarm/readme.html" class="nav-list-link">RTCC alarm interrupt</a></li><li class="nav-list-item "><a href="../../../apps/spi/spi_self_loopback_blocking/readme.html" class="nav-list-link">SPI blocking</a></li><li class="nav-list-item "><a href="../../../apps/spi/spi_self_loopback_interrupt/readme.html" class="nav-list-link">SPI interrupt</a></li><li class="nav-list-item "><a href="../../../apps/spi/spi_ping_pong_with_dma/readme.html" class="nav-list-link">SPI ping pong with DMA</a></li><li class="nav-list-item "><a href="../../../apps/spi/spi_ping_pong_with_dma_chain/readme.html" class="nav-list-link">SPI ping pong with DMA Chaining</a></li><li class="nav-list-item "><a href="../../../apps/sqi/sqi_read_write/readme.html" class="nav-list-link">SQI flash read write</a></li><li class="nav-list-item "><a href="../../../apps/tmr/tmr_timer_mode/readme.html" class="nav-list-link">TMR periodic interrupt</a></li><li class="nav-list-item "><a href="../../../apps/tmr1/tmr1_timer_mode/readme.html" class="nav-list-link">TMR1 periodic interrupt</a></li><li class="nav-list-item "><a href="../../../apps/uart/uart_echo_blocking/readme.html" class="nav-list-link">UART echo blocking</a></li><li class="nav-list-item "><a href="../../../apps/uart/uart_echo_interrupt/readme.html" class="nav-list-link">UART echo interrupt</a></li><li class="nav-list-item "><a href="../../../apps/uart/uart_ring_buffer_interrupt/readme.html" class="nav-list-link">UART ring buffer</a></li><li class="nav-list-item "><a href="../../../apps/wdt/wdt_timeout/readme.html" class="nav-list-link">WDT timeout</a></li></ul></li><li class="nav-list-item"><a href="../../../release_notes.html" class="nav-list-link">Release notes</a></li><li class="nav-list-item"><a href="../../../mplab_harmony_license.html" class="nav-list-link">License</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Harmony 3 peripheral library application examples for PIC32MZ EF family" aria-label="Search Harmony 3 peripheral library application examples for PIC32MZ EF family" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://support.microchip.com" class="site-button" > Obtain Support from Microchip </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../../index.html">Harmony 3 peripheral library application examples for PIC32MZ EF family</a></li> <li class="breadcrumb-nav-list-item"><span>Cache maintenance operations</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <p><a href="https://www.microchip.com"><img src="https://www.microchip.com/ResourcePackages/Microchip/assets/dist/images/logo.png" alt="MCHP" /></a></p> <h1 id="cache-maintenance-operations"> <a href="#cache-maintenance-operations" aria-labelledby="cache-maintenance-operations" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cache maintenance operations </h1> <p>This example demonstrates the cache maintenance operation by cleaning and invalidating the cache for the DMA buffers located in the cacheable SRAM region.</p> <h2 id="description"> <a href="#description" aria-labelledby="description" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description </h2> <p>This example application shows how to use the cache maintenance APIs to avoid issues related to cache coherency when the data cache is enabled.</p> <p>The application uses the USART and the DMA PLIBs to demonstrate the cache maintenance APIs provided by the Cache peripheral library. It registers a callback with the DMA transmit and receive channels. The application first transmits a message using the DMA transmit channel and then schedules a read of ten characters using the DMA receive channel. Once the DMA read is complete, it reads the received data and echoes the same on the terminal using the DMA transmit channel.</p> <p>The application calls the DCACHE_CLEAN_BY_ADDR API on the write buffer before transmitting it. Calling this API copies the data from the cache memory to the main memory, thereby ensuring that the DMA peripheral uses the updated values in the write buffer.</p> <p>The application calls the DCACHE_INVALIDATE_BY_ADDR API on the read buffer after reception of data is complete by the DMA receive channel. Calling this API invalidates the cache region corresponding to the read buffer, thereby ensuring that the CPU reads the updated values in the read buffer from the main memory and into the cache.</p> <p>The cache maintenance operations are always performed on a cache line (1 cache line = 32 bytes), the read and write buffers must be aligned to a 32 byte boundary and must be a multiple of 32 bytes. For the same reason, the number of received and echoed back bytes is 10, the size of the receive and echo buffers is 32 bytes.</p> <h2 id="downloading-and-building-the-application"> <a href="#downloading-and-building-the-application" aria-labelledby="downloading-and-building-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downloading and building the application </h2> <p>To clone or download this application from Github, go to the <a href="https://github.com/Microchip-MPLAB-Harmony/csp_apps_pic32mz_ef">main page of this repository</a> and then click <strong>Clone</strong> button to clone this repository or download as zip file. This content can also be downloaded using content manager by following these <a href="https://github.com/Microchip-MPLAB-Harmony/contentmanager/wiki">instructions</a>.</p> <p>Path of the application within the repository is <strong>apps/cache/cache_maintenance/firmware</strong> .</p> <p>To build the application, refer to the following table and open the project using its IDE.</p> <div class="table-wrapper"><table> <thead> <tr> <th>Project Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>pic32mz_ef_sk.X</td> <td>MPLABX project for <a href="https://www.microchip.com/DevelopmentTools/ProductDetails/dm320007">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a></td> </tr> <tr> <td> </td> <td> </td> </tr> </tbody> </table></div> <h2 id="setting-up-the-hardware"> <a href="#setting-up-the-hardware" aria-labelledby="setting-up-the-hardware" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up the hardware </h2> <p>The following table shows the target hardware for the application projects.</p> <div class="table-wrapper"><table> <thead> <tr> <th style="text-align: left">Project Name</th> <th style="text-align: center">Board</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">pic32mz_ef_sk.X</td> <td style="text-align: center"><a href="https://www.microchip.com/DevelopmentTools/ProductDetails/dm320007">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a></td> </tr> <tr> <td style="text-align: left"> </td> <td style="text-align: center"> </td> </tr> </tbody> </table></div> <h3 id="setting-up-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit"> <a href="#setting-up-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit" aria-labelledby="setting-up-pic32mz-embedded-connectivity-with-fpu-ef-starter-kit" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting up <a href="https://www.microchip.com/DevelopmentTools/ProductDetails/dm320007">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a> </h3> <ul> <li>Connect mini USB cables from the ‘Debug USB’ and ‘USB-to-UART’ connectors on the board to the computer</li> </ul> <h2 id="running-the-application"> <a href="#running-the-application" aria-labelledby="running-the-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Running the Application </h2> <ol> <li>Open the Terminal application (Ex.:Tera term) on the computer</li> <li>Connect to the EDBG Virtual COM port and configure the serial settings as follows: <ul> <li>Baud : 115200</li> <li>Data : 8 Bits</li> <li>Parity : None</li> <li>Stop : 1 Bit</li> <li>Flow Control : None</li> </ul> </li> <li>Build and Program the application using its respective IDE</li> <li> <p>The console displays the following message</p> <p><img src="../../../apps/cache/cache_maintenance/images/output_cache_maintenance.png" alt="output" /></p> </li> <li>Type 10 characters in the terminal. It will echo back the received bytes and toggles the LED</li> <li>The following table provides the LED names:</li> </ol> <div class="table-wrapper"><table> <thead> <tr> <th>Board</th> <th>LED name</th> </tr> </thead> <tbody> <tr> <td><a href="https://www.microchip.com/DevelopmentTools/ProductDetails/dm320007">PIC32MZ Embedded Connectivity with FPU (EF) Starter Kit</a></td> <td>LED1</td> </tr> <tr> <td> </td> <td> </td> </tr> </tbody> </table></div> <hr> <footer> <p class="text-small text-grey-dk-000 mb-0"><img src='https://raw.githubusercontent.com/wiki/Microchip-MPLAB-Harmony/Microchip-MPLAB-Harmony.github.io/images/microchip_logo.png' /><br />Copyright &copy; 2020 Microchip Technology.</p> <!-- <p class="text-small text-grey-dk-000 mb-0"><img src='../../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2023 Microchip Technology.</p> --> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
